{% extends "main.html" %}
{% block content %}
<style type="text/css">
/* ----------------------------------------------
 * Generated by Animista on 2019-3-6 15:21:13
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/**
 * ----------------------------------------
 * animation slit-in-vertical
 * ----------------------------------------
 */
@-webkit-keyframes slit-in-vertical {
  0% {
    -webkit-transform: translateZ(-800px) rotateY(90deg);
            transform: translateZ(-800px) rotateY(90deg);
    opacity: 0;
  }
  54% {
    -webkit-transform: translateZ(-160px) rotateY(87deg);
            transform: translateZ(-160px) rotateY(87deg);
    opacity: 1;
  }
  100% {
    -webkit-transform: translateZ(0) rotateY(0);
            transform: translateZ(0) rotateY(0);
  }
}
@keyframes slit-in-vertical {
  0% {
    -webkit-transform: translateZ(-800px) rotateY(90deg);
            transform: translateZ(-800px) rotateY(90deg);
    opacity: 0;
  }
  54% {
    -webkit-transform: translateZ(-160px) rotateY(87deg);
            transform: translateZ(-160px) rotateY(87deg);
    opacity: 1;
  }
  100% {
    -webkit-transform: translateZ(0) rotateY(0);
            transform: translateZ(0) rotateY(0);
  }
}

.slit-in-vertical {
	-webkit-animation: slit-in-vertical 0.45s ease-out both;
	        animation: slit-in-vertical 0.45s ease-out both;
}

.slit-in-vertical:nth-child(1){
	-webkit-animation-delay: .5s;
}
.slit-in-vertical:nth-child(2){
	-webkit-animation-delay: 1s;
}
.slit-in-vertical:nth-child(3){
	-webkit-animation-delay: 1.5s;
}
.slit-in-vertical:nth-child(4){
	-webkit-animation-delay: 2s;
}
.slit-in-vertical:nth-child(5){
	-webkit-animation-delay: 2.5s;
}
.slit-in-vertical:nth-child(6){
	-webkit-animation-delay: 3s;
}

</style>

<section id="index-app">
	<div class="bg-dark container">
		<div id="home" class="jumbotron bg-dark text-center variantHero" style="padding:30vh 0px 50vh 0px">
			<h1 class="text-light lighter textShadow" data-aos="fade-up" data-aos-duration="1000">
				<span class="bold">Pending</span> BioThings APIs
			</h1>
		</div>

		<!-- <div data-aos="fade-up" data-aos-duration="3000" class="jumbotron bg-dark text-light text-center">
      <div class="gradientBox">
        <div class="bg-dark jumbotron">
					<img style="border:0px;" width="100px" src="https://i.gifer.com/S9Ab.gif" alt="Logo 64"/>
          <h1 class="mb-5 shine">
            Welcome
          </h1>
          <h1 class="m-5 shine">
            More
          </h1>
          <a class="mr-3 link" href="#pending"><i class="fas fa-chevron-right"></i> View More Pending APIs</a>
          <a class="mr-3 link" href="#contribute"><i class="fas fa-chevron-right"></i> Learn How To Contribute</a>
          <a class="mr-3 link" href="#help"><i class="fas fa-chevron-right"></i> Need Help?</a>
        </div>
      </div>
    </div> -->

    <!-- <div data-aos="fade-up" data-aos-duration="3000" class="jumbotron bg-dark text-light text-center">
      <div class="gradientBox">
        <div class="bg-dark jumbotron">
					<img style="border:0px;" width="100px" src="https://i.gifer.com/S9Ab.gif" alt="Logo 64"/>
          <h1 class="mb-5 shine">
            Featured
          </h1>
          <div class="bg-warning w-75 m-auto" style="padding:2px;">
            <div v-if="pending.length" class="bg-dark p-5">
              <h3 class="font-weight-bold" v-text='getKeyName(pending[0].src)'></h3>
              <template v-if='pending[0].src[getKeyName(pending[0].src)]["author"]'>
                <small class="d-block">
                  Developed by
                  <a :href='pending[0].src[getKeyName(pending[0].src)]["author"]["url"]' target="_blank" class="link">
                    <i class="fab fa-github"></i> <span v-text='pending[0].src[getKeyName(pending[0].src)]["author"]["name"]'></span>
                  </a>
                </small>
              </template>
              <small class="badge bg-dark" v-text="numberWithCommas(pending[0].src[getKeyName(pending[0].src)].stats[getKeyName(pending[0].src)])+' documents'"></small>
              <div>
                <hr />
                <small>Pending for integration with:</small>
                <div>
                  <a v-if="pending[0].doc_type === 'gene'" target="_blank" href="http://mygene.info/"><img  src="/static/img/mygene-text.svg" height="20px"/></a>
                  <a v-if="pending[0].doc_type === 'variant'" target="_blank" href="http://myvariant.info"><img  src="/static/img/myvariant-text.svg" height="20px"/></a>
                  <a v-if="pending[0].doc_type === 'chemical'" target="_blank" href="http://mychem.info"><img src="/static/img/mychem-text.svg" height="20px"/></a>
                </div>
              </div>
              <div class="p-3 mt-4" style="position: relative">
                <a class="btn-main" :href="'./'+getKeyName(pending[0].src)">Try It</a>
              </div>
            </div>
          </div>
          <h1 class="m-5 shine">
            More
          </h1>
          <a class="mr-3 link" href="#pending"><i class="fas fa-chevron-right"></i> View More Pending APIs</a>
          <a class="mr-3 link" href="#contribute"><i class="fas fa-chevron-right"></i> Learn How To Contribute</a>
          <a class="mr-3 link" href="#help"><i class="fas fa-chevron-right"></i> Need Help?</a>
        </div>
      </div>
    </div> -->

    <div data-aos="fade-up" data-aos-duration="3000" id="pending" class="jumbotron bg-dark text-light text-center">
      <div class="gradientBox">
        <div class="bg-dark jumbotron">
          <h1 class="mb-5">
            Pending APIs
          </h1>
					<p class="w-75 m-auto">
						Pending BioThings APIs are a collection of community-contributed APIs from various data sources. They were built using <a class="link" href="https://biothingsapi.readthedocs.io/en/latest/" target="_blank">BioThings SDK</a> and follow the same design pattern of our official BioThings APIs (<a class="link" href="https://mygene.info" target="_blank">MyGene.info</a>, <a class="link" href="https://myvariant.info" target="_blank">MyVariant.info</a>, <a class="link" href="https://mychem.info" target="_blank">MyChem.info</a>, etc). These APIs are also pending to be integrated into the proper official BioThings API based on their entity type.
					</p>
          <object data-aos="fade-in" id="hero1" width="70%" type="image/svg+xml" data="static/img/hero-1.svg"></object>
          <!-- <form class="w-50 m-auto" @submit.prevent="search(query)">
            <div class="form-group row">
              <input type="text" v-model="query" class="form-control bg-secondary text-light col-sm-7 mr-1" id="exampleFormControlInput1" placeholder="Search">
              <button @click.prevent="search(query)" class="btn btn-outline-dark text-white col-sm-2 mr-1">Search</button>
              <button @click.prevent="getMetadata(); query=''" class="btn btn-outline-dark text-white col-sm-2">Reset</button>
            </div>
          </form> -->
          <div class="text-muted font-weight-light">
            <small>(<span v-text="pending.length"></span>) APIs</small>
          </div>
          <div class="flexP">
            <div v-for="(api,index) in pending" class="flexC apiBack slit-in-vertical" v-if="index < shown">
              <h3 class="font-weight-bold" v-text='getKeyName(api.src)'></h3>
              <!-- <template v-if='api.src[getKeyName(api.src)]["author"]'>
                <small class="d-block">
                  Developed by
                  <a :href='api.src[getKeyName(api.src)]["author"]["url"]' target="_blank" class="link">
                    <i class="fab fa-github"></i> <span v-text='api.src[getKeyName(api.src)]["author"]["name"]'></span>
                  </a>
                </small>
              </template> -->
              <small class="badge bg-dark" v-text="numberWithCommas(api.src[getKeyName(api.src)].stats[getKeyName(api.src)])+' documents'"></small>
              <div>
                <hr />
                <small>Pending for integration with:</small>
                <div v-if="api.biothing_type">
                  <a v-if="api.biothing_type === 'gene'" target="_blank" href="http://mygene.info/"><img  src="/static/img/mygene-text.svg" height="20px"/></a>
                  <a v-if="api.biothing_type === 'variant'" target="_blank" href="http://myvariant.info"><img  src="/static/img/myvariant-text.svg" height="20px"/></a>
                  <a v-if="api.biothing_type === 'chemical'" target="_blank" href="http://mychem.info"><img src="/static/img/mychem-text.svg" height="20px"/></a>
                </div>
								<div v-if="api.biothing_type">
                  <span v-text="api.biothing_type"></span>
                </div>
              </div>
              <div class="p-3 mt-4" style="position: relative">
                <a class="btn-main" :href="'./'+getKeyName(api.src)">Try It</a>
              </div>
            </div>
            <div class="mb-5 w-100" v-if="shown < pending.length">
              <button class="btn btn-outline-dark text-light" @click="shown = shown+3">Load More</button>
            </div>
          </div>
          <small class="text-muted">
            <i class="fas fa-exclamation-circle"></i> Disclaimer: Testing for pending APIs is still undergoing and cannot guaratee reliability of these APIs during this process. Use at you own risk.
          </small>
        </div>
      </div>
    </div>




    <div id="contribute" data-aos="fade-up" data-aos-duration="3000" class="jumbotron bg-dark text-light text-center">
      <div class="gradientBox">
        <div class="bg-dark jumbotron">
          <h1 class="mb-5">
            Contribute
          </h1>
          <!-- <object width="50%" data="static/img/contribute.gif"></object> -->
          <div id="animation_container" style="background-color:rgba(68, 68, 68, 00); width:640px; height:480px; zoom:.5;">
        		<canvas id="canvas" width="640" height="480" style="position: absolute; display: block; background-color:rgba(68, 68, 68,0);"></canvas>
        		<div id="dom_overlay_container" style="pointer-events:none; overflow:hidden; width:640px; height:480px; position: absolute; left: 0px; top: 0px; display: block;">
        		</div>
        	</div>
          <h2 class="text-light">
            Want to build your own API?
          </h2>
					<a class="link mb-5" target="_blank" href="https://biothingsapi.readthedocs.io/en/latest/doc/studio.html">
						<h3>Follow this guide</h3>
					</a>
					<hr />
          <div class="container p-2 text-center">
            <h3 class="mb-3">Development Environment</h3>
            <a class="link" target="_blank" href="http://docs.biothings.io/en/latest/doc/studio.html" title="BioThings Studio">
              <img style="border:0px;" width="128" src="http://biothings.io/static/img/biothings-studio-128.png" alt="Logo 128"/>
              <small class="d-block">
                Learn More
              </small>
            </a>
            <hr class="m-4"/>
            <h3 class="mb-3">Data Sources</h3>
            <div class="row w-75 m-auto">
              <div class="col-sm-12 col-md-4">
                <a class="link" target="_blank" href="https://mygene.info/" title="MyGene.info">
                  <img style="border:0px;" width="128" src="http://biothings.io/static/img/mygene-logo-128.png" alt="Logo 128"/>
                  <small class="d-block">
                    Learn More
                  </small>
                </a>
              </div>
              <div class="col-sm-12 col-md-4">
                <a class="link" target="_blank" href="https://myvariant.info/" title="MyVariant.info">
                  <img style="border:0px;" width="128" src="http://biothings.io/static/img/myvariant-logo-128.png" alt="Logo 128"/>
                  <small class="d-block">
                    Learn More
                  </small>
                </a>
              </div>
              <div class="col-sm-12 col-md-4">
                <a class="link" target="_blank" href="https://mychem.info/" title="MyChem.info">
                  <img style="border:0px;" width="128" src="http://biothings.io/static/img/mychem-logo-128.png" alt="Logo 128"/>
                  <small class="d-block">
                    Learn More
                  </small>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="help" data-aos="fade-up" data-aos-duration="3000" class="jumbotron bg-dark text-light text-center">
      <div class="gradientBox">
        <div class="bg-dark jumbotron">
					<img style="border:0px;" width="100px" src="https://i.gifer.com/S9Ab.gif" alt="Logo 64"/>
          <h1 class="mb-5">
            Neep Help?
          </h1>
          <div class="container p-4" style="position: relative;">
            <a class="btn-main" href="mailto:biothings@googlegroups.com" target="_blank">Contact Us</a>
          </div>
        </div>
      </div>
    </div>
    <div class="jumbotron bg-dark text-muted text-center">

    </div>
	</div>
</section>



{% endblock %}
			{% block extra_scripts %}
      <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.2/vue.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
			<script src="/static/js/app.js"></script>
      <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
			<script>
      AOS.init();
      var app = new Vue({
        el: '#index-app',
        data: function(){
          return {
            pendingApis:[
              {
               'metadataUrl':'//pending.biothings.io/denovodb/metadata'
              },
              {
                'metadataUrl':'//pending.biothings.io/ccle/metadata'
              },
              {
               'metadataUrl':'//pending.biothings.io/kaviar/metadata'
               },
               {
                'metadataUrl':'//pending.biothings.io/fire/metadata'
                },
	              {
	               'metadataUrl':'//pending.biothings.io/biomuta/metadata'
	               }
             ],
             pending:[],
             shown:6,
             query:"",
             apiSelected:'',
             querySelected:'',
             queryString:'',
             querySelectionType:'example',
             success: false
          }
        },
        methods: {
          search(query){
            let self = this;
            let res=[];

            if (query) {
              for (var i = 0; i < self.pending.length; i++) {
                let title = self.getKeyName(self.pending[i].src)
                if (title.toLowerCase().includes(query.toLowerCase())) {
                  res.push(self.pending[i]);
                }
              }
              self.pending = res;
            }else{
              self.getMetadata();
            }
          },
          numberWithCommas(x) {
              return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
          },
          getKeyName(obj){
            for (var key in obj) {
              return key;
            }
          },
          getMetadata(){
            let self = this;
            self.pending=[];
            for (var i = 0; i < self.pendingApis.length; i++) {
              axios.get(self.pendingApis[i].metadataUrl).then(res=>{
                self.pending.push(res.data);
              }).catch(err=>{
                throw err;
              })
            }
          },
          loadAnimation(){
            var canvas, stage, exportRoot, anim_container, dom_overlay_container, fnStartAnimation;
            function init() {
	            canvas = document.getElementById("canvas");
	            anim_container = document.getElementById("animation_container");
	            dom_overlay_container = document.getElementById("dom_overlay_container");
	            var comp=AdobeAn.getComposition("F8749D7504C942628AEBFA078DBD04C6");
	            var lib=comp.getLibrary();
	            var loader = new createjs.LoadQueue(false);
	            loader.addEventListener("fileload", function(evt){handleFileLoad(evt,comp)});
	            loader.addEventListener("complete", function(evt){handleComplete(evt,comp)});
	            var lib=comp.getLibrary();
	            loader.loadManifest(lib.properties.manifest);
            }
            function handleFileLoad(evt, comp) {
	            var images=comp.getImages();
	            if (evt && (evt.item.type == "image")) { images[evt.item.id] = evt.result; }
            }
            function handleComplete(evt,comp) {
            //This function is always called, irrespective of the content. You can use the variable "stage" after it is created in token create_stage.
            var lib=comp.getLibrary();
            var ss=comp.getSpriteSheet();
            var queue = evt.target;
            var ssMetadata = lib.ssMetadata;
            for(i=0; i<ssMetadata.length; i++) {
              ss[ssMetadata[i].name] = new createjs.SpriteSheet( {"images": [queue.getResult(ssMetadata[i].name)], "frames": ssMetadata[i].frames} )
            }
            exportRoot = new lib.contribute();
            stage = new lib.Stage(canvas);
            //Registers the "tick" event listener.
            fnStartAnimation = function() {
              stage.addChild(exportRoot);
              createjs.Ticker.setFPS(lib.properties.fps);
              createjs.Ticker.addEventListener("tick", stage)
              stage.addEventListener("tick", handleTick)
              function getProjectionMatrix(container, totalDepth) {
                var focalLength = 528.25;
                var projectionCenter = { x : lib.properties.width/2, y : lib.properties.height/2 };
                var scale = (totalDepth + focalLength)/focalLength;
                var scaleMat = new createjs.Matrix2D;
                scaleMat.a = 1/scale;
                scaleMat.d = 1/scale;
                var projMat = new createjs.Matrix2D;
                projMat.tx = -projectionCenter.x;
                projMat.ty = -projectionCenter.y;
                projMat = projMat.prependMatrix(scaleMat);
                projMat.tx += projectionCenter.x;
                projMat.ty += projectionCenter.y;
                return projMat;
              }
              function handleTick(event) {
                var cameraInstance = exportRoot.___camera___instance;
                if(cameraInstance !== undefined && cameraInstance.pinToObject !== undefined)
                {
                  cameraInstance.x = cameraInstance.pinToObject.x + cameraInstance.pinToObject.pinOffsetX;
                  cameraInstance.y = cameraInstance.pinToObject.y + cameraInstance.pinToObject.pinOffsetY;
                  if(cameraInstance.pinToObject.parent !== undefined && cameraInstance.pinToObject.parent.depth !== undefined)
                  cameraInstance.depth = cameraInstance.pinToObject.parent.depth + cameraInstance.pinToObject.pinOffsetZ;
                }
                applyLayerZDepth(exportRoot);
              }
              function applyLayerZDepth(parent)
              {
                var cameraInstance = parent.___camera___instance;
                var focalLength = 528.25;
                var projectionCenter = { 'x' : 0, 'y' : 0};
                if(parent === exportRoot)
                {
                  var stageCenter = { 'x' : lib.properties.width/2, 'y' : lib.properties.height/2 };
                  projectionCenter.x = stageCenter.x;
                  projectionCenter.y = stageCenter.y;
                }
                for(child in parent.children)
                {
                  var layerObj = parent.children[child];
                  if(layerObj == cameraInstance)
                    continue;
                  applyLayerZDepth(layerObj, cameraInstance);
                  if(layerObj.layerDepth === undefined)
                    continue;
                  if(layerObj.currentFrame != layerObj.parent.currentFrame)
                  {
                    layerObj.gotoAndPlay(layerObj.parent.currentFrame);
                  }
                  var matToApply = new createjs.Matrix2D;
                  var cameraMat = new createjs.Matrix2D;
                  var totalDepth = layerObj.layerDepth ? layerObj.layerDepth : 0;
                  var cameraDepth = 0;
                  if(cameraInstance && !layerObj.isAttachedToCamera)
                  {
                    var mat = cameraInstance.getMatrix();
                    mat.tx -= projectionCenter.x;
                    mat.ty -= projectionCenter.y;
                    cameraMat = mat.invert();
                    cameraMat.prependTransform(projectionCenter.x, projectionCenter.y, 1, 1, 0, 0, 0, 0, 0);
                    cameraMat.appendTransform(-projectionCenter.x, -projectionCenter.y, 1, 1, 0, 0, 0, 0, 0);
                    if(cameraInstance.depth)
                      cameraDepth = cameraInstance.depth;
                  }
                  if(layerObj.depth)
                  {
                    totalDepth = layerObj.depth;
                  }
                  //Offset by camera depth
                  totalDepth -= cameraDepth;
                  if(totalDepth < -focalLength)
                  {
                    matToApply.a = 0;
                    matToApply.d = 0;
                  }
                  else
                  {
                    if(layerObj.layerDepth)
                    {
                      var sizeLockedMat = getProjectionMatrix(parent, layerObj.layerDepth);
                      if(sizeLockedMat)
                      {
                        sizeLockedMat.invert();
                        matToApply.prependMatrix(sizeLockedMat);
                      }
                    }
                    matToApply.prependMatrix(cameraMat);
                    var projMat = getProjectionMatrix(parent, totalDepth);
                    if(projMat)
                    {
                      matToApply.prependMatrix(projMat);
                    }
                  }
                  layerObj.transformMatrix = matToApply;
                }
              }
            }
            //Code to support hidpi screens and responsive scaling.
            function makeResponsive(isResp, respDim, isScale, scaleType) {
              var lastW, lastH, lastS=1;
              window.addEventListener('resize', resizeCanvas);
              resizeCanvas();
              function resizeCanvas() {
                var w = lib.properties.width, h = lib.properties.height;
                var iw = window.innerWidth, ih=window.innerHeight;
                var pRatio = window.devicePixelRatio || 1, xRatio=iw/w, yRatio=ih/h, sRatio=1;
                if(isResp) {
                  if((respDim=='width'&&lastW==iw) || (respDim=='height'&&lastH==ih)) {
                    sRatio = lastS;
                  }
                  else if(!isScale) {
                    if(iw<w || ih<h)
                      sRatio = Math.min(xRatio, yRatio);
                  }
                  else if(scaleType==1) {
                    sRatio = Math.min(xRatio, yRatio);
                  }
                  else if(scaleType==2) {
                    sRatio = Math.max(xRatio, yRatio);
                  }
                }
                canvas.width = w*pRatio*sRatio;
                canvas.height = h*pRatio*sRatio;
                canvas.style.width = dom_overlay_container.style.width = anim_container.style.width =  w*sRatio+'px';
                canvas.style.height = anim_container.style.height = dom_overlay_container.style.height = h*sRatio+'px';
                stage.scaleX = pRatio*sRatio;
                stage.scaleY = pRatio*sRatio;
                lastW = iw; lastH = ih; lastS = sRatio;
                stage.tickOnUpdate = false;
                stage.update();
                stage.tickOnUpdate = true;
              }
            }
            makeResponsive(true,'both',true,1);
            AdobeAn.compositionLoaded(lib.properties.id);
            fnStartAnimation();
            }

            $( document ).ready(function() {
                init();
            });
            document.getElementById("animation_container").addEventListener('hover', function(){
    					init();
    				})
          }

        },
          mounted: function(){
            this.loadAnimation();
            this.getMetadata()
          }
      });

      new Vivus('hero1', {duration: 150});

      let timer = setInterval(function(){
        new Vivus('hero1', {duration: 150});
      }, 30000);


      // Smooth Scrolling to Anchors
      // Select all links with hashes
      $('a[href*="#"]')
        // Remove links that don't actually link to anything
        .not('[href="#"]')
        .not('[href="#0"]')
        .click(function(event) {
          // On-page links
          if (
            location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '')
            &&
            location.hostname == this.hostname
          ) {
            // Figure out element to scroll to
            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
            // Does a scroll target exist?
            if (target.length) {
              // Only prevent default if animation is actually gonna happen
              event.preventDefault();
              $('html, body').animate({
                scrollTop: target.offset().top
              }, 1000, function() {
                // Callback after animation
                // Must change focus!
                var $target = $(target);
                $target.focus();
                if ($target.is(":focus")) { // Checking if the target was focused
                  return false;
                } else {
                  $target.attr('tabindex','-1'); // Adding tabindex for elements not focusable
                  $target.focus(); // Set focus again
                };
              });
            }
          }
        });
			</script>
			{% endblock %}
